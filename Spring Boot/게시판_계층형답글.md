# 2023.01.15(ì¼)

# âœï¸ What I learned Today ?

---


## ğŸ’œ(ìµœì¢…í”Œì ) SPRING BOOT ì‘ì—…ê¸°ë¡

---


### âœ¨ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ íŒŒë¼ë¯¸í„° ë‹¤ë£¨ê¸°

```java

//ë‹µê¸€ë‹¬ê¸° ëˆŒëŸ¬ì„œ qnaReplyformìœ¼ë¡œ url ë“¤ì–´ì˜¤ë©´ ì„¸ì…˜ì— ì›ê¸€ ë²ˆí˜¸ë¥¼ origin_noë¡œ ì €ì¥í•´ì„œ qnaReply ë¦¬í„´
	@GetMapping("/qnaReply")
	public String qnaReply(HttpServletRequest request) {
		
		origin_no = Integer.parseInt(request.getParameter("qna_no"));
		qna_type = request.getParameter("qna_type");
		secret = request.getParameter("secret");
		
		session = request.getSession(); //ì„¸ì…˜ìƒì„±
		session.setAttribute("origin_no",origin_no);//origin_no = qna_noë¡œ ì„¸ì…˜ì— ì €ì¥
		session.setAttribute("qna_type",qna_type);  
		session.setAttribute("secret", secret);
		
		return "/customer/qnaReply";
		
	}
	
	//ë‹µë³€formì—ì„œ ë„˜ì–´ì™€ì„œ ë°ì´í„°ì— ì…ë ¥í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬
	@PostMapping("/qnainsertReply")
	public String qnainsertReply(HttpServletRequest request, QnaDto dto) throws IOException{
		
		origin_no = (Integer)session.getAttribute("origin_no");
		qna_type = session.getAttribute("qna_type").toString();
		secret = session.getAttribute("secret").toString();

		//ì „ë‹¬í•  dtoì— setí•œë‹¤.
		dto.setOrigin_no(origin_no);
		dto.setQna_type(qna_type);
		dto.setSecret(secret);

		qnabiz.insertReply(dto);
		
		return "redirect:/customer/qnalist";
	}



    //jspì— ë‹µê¸€ì“°ê¸° ë²„íŠ¼
    <input type="button" value="ë‹µê¸€ì“°ê¸°" onclick="location.href='/customer/qnaReply?qna_no=${dto.qna_no}&qna_type=${dto.qna_type}&secret=${dto.secret}'">
	
```

<br>

> ğŸ’ª ***what i learn***   ::
    ìš”ì²­ê³¼ ì‘ë‹µ (jspí˜ì´ì§€ - ì»¨íŠ¸ë¡¤ëŸ¬) ì—ì„œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” íë¦„ì„ ê½¤ ì²´ë“í–ˆë‹¤!
    <br>
    **
    ì„¸ì…˜ì„ ìœ ì§€í•˜ë©´ì„œ íŒŒë¼ë¯¸í„°ë¥¼ ê·¸ëŒ€ë¡œ ë„˜ê²¨ì¤˜ì•¼í• ë•Œ 
    (ex) ë‹µê¸€ì“°ê¸°ë¡œ ë„˜ì–´ê°€ë©´ì„œ ì›ë˜ê¸€ì— ëŒ€í•œ ì •ë³´ë„ ê°™ì´ ë„˜ê¸¸ë•Œ..
    jspì—ì„œ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë„˜ê²¨ì¤€ ë°ì´í„°ë¥¼ í™œìš©í•˜ë ¤ë©´,
    HttpServletRequest requestë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ì„œ ë³€ìˆ˜ì— getParameterë¡œ ê°’ì„ ë‹¤ì‹œ ì €ì¥í•´ì£¼ê³  session ìƒì„±í•´ì„œ ê·¸ ê°’ì„ ë‹¤ì‹œ setAttributeë¡œ ì„¸ì…˜ì¿ í‚¤ì— ì €ì¥. 
    ê·¸ë¦¬ê³  DBì— ì…ë ¥ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë‹¤ì‹œ ì„¸ì…˜ì— ì €ì¥ëœ ê°’ì„
    getAttributeë¡œ ê°€ì ¸ì™€ì„œ ì•Œë§ì€ ê°ì²´íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•´ì¤€ë’¤ dtoì— Setterë¡œ ë„£ì–´ì„œ 
    ë‹¤ì‹œ ë„˜ê²¨ì¤€ë‹¤.






<br>
---
<br>
### âœ¨ ê³„ì¸µí˜• ê²Œì‹œíŒ ë§Œë“¤ê¸°

##### ê¸°ë³¸ ê²Œì‹œíŒì—ì„œ ë³€ê²½ì‚¬í•­ : 
- ë°ì´í„°ì— ì»¬ëŸ¼ ì¶”ê°€ / selectAll ì¿¼ë¦¬ë¬¸ ë³€ê²½


**QnaMapper**


```java

@Select("WITH RECURSIVE CTE AS\r\n"
			+ "(\r\n"
			+ "SELECT QNA_NO, USER_ID, QNA_TYPE, QNA_TITLE, QNA_DATE,QNA_CONTENT,ORIGIN_NO,GROUPORD,DEP,SECRET,\r\n"
			+ "QNA_NO AS PATH, 1 AS LEVEL FROM QNA\r\n"
			+ "WHERE ORIGIN_NO=0\r\n"
			+ "UNION ALL\r\n"
			+ "SELECT B.QNA_NO, B.USER_ID, B.QNA_TYPE, B.QNA_TITLE, B.QNA_DATE,B.QNA_CONTENT,B.ORIGIN_NO,B.GROUPORD,B.DEP,B.SECRET,\r\n"
			+ "CONCAT(C.PATH,\".\",B.QNA_NO) AS PATH,\r\n"
			+ "C.LEVEL+1 AS LEVEL\r\n"
			+ "FROM CTE C JOIN QNA B ON C.QNA_NO = B.ORIGIN_NO\r\n"
			+ ")\r\n"
			+ "SELECT QNA_NO, USER_ID ,QNA_TYPE , CONCAT(REPEAT(\" \", LEVEL*4), QNA_TITLE) QNA_TITLE ,QNA_DATE, QNA_CONTENT, \r\n"
			+ "ORIGIN_NO,DEP,SECRET, PATH, LEVEL FROM CTE ORDER BY PATH;\r\n"
			+ "")
	List<QnaDto> selectList();
	
```


**QnaDto**
```java
public class QnaDto {
	private Integer qna_no;
	private String user_id;
	private String qna_type;
	private String qna_title;
	private Date qna_date;
	private String qna_content;
	//ê³„ì¸µí˜• ê²Œì‹œíŒì— í•„ìš”í•œ í•„ë“œ ì¶”ê°€
	private Integer origin_no; //qna_noì™€ ë™ì¼
	private int groupOrd; //ì›ê¸€+ë‹µë³€ê¸€ ë¬¶ì–´ì„œ ì •ë¦¬í•  int
	private int dep; //ë ˆì´ì–´ì„¤ì •ì— í•„ìš”í•œ í•„ë“œ
	private String secret; //ë¹„ë°€ê¸€ ì„¤ì •ì— í•„ìš”í•œ í•„ë“œ 
    }
    //ìƒì„±ì,ê²Œí„°ì„¸í„° ìƒëµ
```



<br>

---





> ğŸ’ª ***what i learn***   ::
    ì°¾ì•„ë³´ëŠë¼ ê³ ê¸‰ SQL ì°ë¨¹í–ˆëŠ”ë°.. ì–´ë µë‹¤. 
    ì˜¤ë¼í´ì€ ê³„ì¸µí˜• ê²Œì‹œíŒì´ ì‰½ê²Œ ì„¤ì •ëœë‹¤ê³  í•˜ëŠ”ë°, 
    MySQLì€ ì¡°ê¸ˆ ë” ë³µì¡í–ˆë‹¤.. ì´í•´ëŠ” ì™„ë²½íˆ ëª»í–ˆìœ¼ë‹ˆ ë‹¤ì‹œ ìˆ™ì§€í• ê²ƒ.    
    ìš°ì„ , í”„ë¡œì íŠ¸ ë°œí‘œ ëë‚˜ê³  ë¦¬íŒ©í† ë§ í•˜ë©´ì„œ ëŒ€ëŒ€ëŒ“ê¸€(3dep)ê¹Œì§€ ê³„ì¸µì„ í™•ì¥ì‹œì¼œë³´ë©´ ì¢‹ì„ë“¯.